{{ define "title" }}{{ .ShowData.Name }} Details{{ end }}


{{ define "content" }}


<div class="max-w-3xl bg-white dark:bg-black p-6 rounded shadow space-y-6">
    {{ template "nav-bar" . }}

    <!-- Show Info -->
    <div class="flex gap-6">
        <img src="{{ .ShowData.Poster }}" alt="{{ .ShowData.Name }} poster" class="w-40 h-60 object-cover border">
        <div class="flex-1 space-y-2">
            <div class="flex items-center justify-between">
                <h2 class="text-3xl font-bold text-gray-900 dark:text-gray-100">
                    {{ .ShowData.Name }} ({{ dateToYear .ShowData.AirDate }})
                </h2>

                {{ if .Added }}
                <button onclick="window.location.href='/show/remove?id={{ .ShowData.ID }}'"
                    class="ml-4 bg-red-600 text-white px-3 py-1 rounded-full hover:bg-red-700 text-sm font-semibold">
                    Remove
                </button>
                {{ else }}
                <button onclick="window.location.href='/show/add?id={{ .ShowData.ID }}'"
                    class="ml-4 bg-blue-600 text-white px-3 py-1 rounded-full hover:bg-blue-700 text-sm font-semibold">
                    Add
                </button>
                {{ end }}
            </div>

            <p class="text-gray-700 dark:text-gray-300">{{ .ShowData.Description }}</p>

            <!-- Show Status -->
            {{ if eq .ShowData.Status "Ended" }}
            <span class="inline-block text-sm font-semibold text-red-700 bg-red-100 px-3 py-1">
                Ended
            </span>
            {{ else }}
            <span class="inline-block text-sm font-semibold text-gray-700 bg-gray-100 px-3 py-1">
                {{ .ShowData.Status }}
            </span>
            {{ end }}

            <!-- Seasons to Watch -->
            <div
                class="w-full px-3 py-2 text-sm font-medium text-{{.ShowData.WatchActionColor}}-800 bg-{{.ShowData.WatchActionColor}}-100 border border-{{.ShowData.WatchActionColor}}-300">
                {{ .ShowData.WatchAction }}
            </div>
        </div>
    </div>

    <hr class="my-6">

    <!-- Seasons -->
    <div>
        <h3 class="text-2xl font-semibold text-gray-800 dark:text-gray-200 mb-4">Seasons</h3>

        <div class="overflow-x-auto">
            {{ if .ShowData.Seasons }}
            <table class="min-w-full divide-y divide-gray-200 shadow-md rounded-lg overflow-hidden">
                <thead class="bg-gray-50 dark:bg-gray-950">
                    <tr>
                        <th scope="col"
                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                            Season Number
                        </th>
                        <th scope="col"
                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                            Episodes
                        </th>
                        <th scope="col"
                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                            Start Date
                        </th>
                        <th scope="col"
                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                            End Date
                        </th>
                        <th scope="col"
                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                            Watched Status
                        </th>
                    </tr>
                </thead>
                <tbody class="bg-white dark:bg-black divide-y divide-gray-200">
                    {{ range .ShowData.Seasons }}
                    <tr
                        class="{{ if .Watched }}bg-red-50 dark:bg-red-950{{ end }} {{ if not .Released }}bg-orange-50 dark:bg-orange-900{{ end }}">
                        <td class=" px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100">
                            {{ .Number }}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300">
                            {{ .Episodes }}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300">
                            {{ .StartDate }}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300">
                            {{ .EndDate }}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300">
                            {{ if .Released }}

                            {{ if .Watched }}
                            <button
                                class="mark-watched-btn inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-full shadow-sm text-white bg-yellow-600 hover:bg-yellow-700"
                                data-season-number="{{ .Number }}" data-show-id="{{ $.ShowData.ID }}"
                                onclick="window.location.href='/show/unwatched?show_id={{ $.ShowData.ID }}&season={{ .Number }}'">
                                Mark Unwatched
                            </button>
                            {{ else }}
                            <button
                                class="mark-watched-btn inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-full shadow-sm text-white bg-indigo-600 hover:bg-indigo-700"
                                data-season-number="{{ .Number }}" data-show-id="{{ $.ShowData.ID }}"
                                onclick="window.location.href='/show/watched?show_id={{ $.ShowData.ID }}&season={{ .Number }}'">
                                Mark Watched
                            </button>
                            {{ end }}

                            {{ else }}

                            Not yet released.

                            {{ end }}
                        </td>
                    </tr>
                    {{ end }}
                </tbody>
            </table>
            {{ else }}
            <p class="text-gray-500 italic p-4">No seasons available.</p>
            {{ end }}
        </div>
    </div>
</div>
{{ end }}